<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Examples</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
</head>
<body>
    <script src="http://demo.qunee.com/lib/qunee-min.js"></script>

    <div id="canvas"
         style="margin: 0 auto;width: 80%;height: 600px;border: 1px solid #ccc;"></div>

    <script type="text/javascript">
      var graph = new Q.Graph('canvas');
      var path = new Q.Path();

      graph.editable = true;

      function calculateDistance(x1, y1, x2, y2) {
        var dx = x1 - x2;
        var dy = y1 - y2;
        return Math.sqrt(dx * dx + dy * dy);
      }

      var points = [
        [100, 200],
        [200, 100],
        [300, 200]
      ];

      path.moveTo(100, 220);
      path.lineTo(100, 200);

      var i = 0;
      var prev, current, next;
      while (i < points.length) {
        current = points[i];
        next = points[i + 1];
        if (!prev) {
          path.moveTo(current[0], current[1]);
        } else if (!next) {
          path.lineTo(current[0], current[1]);
        } else {
          var l1 = calculateDistance(prev[0], prev[1], current[0], current[1]);
          var l2 = calculateDistance(current[0], current[1], next[0], next[1]);
          var r = Math.abs(points[0][0] - points[2][0]) / 2;
          var x0, y0, x1, y1;
          if (l1 <= r) {
            x0 = prev[0];
            y0 = prev[1];
          } else {
            var angle = Math.atan2(prev[1] - current[1], prev[0] - current[0]);
            x0 = current[0] + Math.cos(angle) * r;
            y0 = current[1] + Math.sin(angle) * r;
          }
          if (l2 <= r) {
            x1 = next[0];
            y1 = next[1];
          } else {
            var angle = Math.atan2(next[1] - current[1], next[0] - current[0]);
            x1 = current[0] + Math.cos(angle) * r;
            y1 = current[1] + Math.sin(angle) * r;
          }
          path.lineTo(x0, y0);
          path.quadTo(current[0], current[1], x1, y1);
        }
        prev = current;
        i++;
      }

      path.lineTo(300, 220);

      path.validate();

      var center = points.reduce((res, point, index) => {
        var x = res[0] || 0;
        var y = res[1] || 0;

        x += point[0];
        y += point[1];

        if (index == points.length - 1) {
          return [x / points.length, y / points.length]
        }

        return [x, y];
      }, []);

      var line = graph.createNode(null, center[0], center[1]);
      line.setStyle(Q.Styles.SHAPE_STROKE, 1);
      line.setStyle(Q.Styles.SHAPE_STROKE_STYLE, '#ff0000');
      line.setStyle(Q.Styles.SHAPE_FILL_COLOR, null);
      line.image = path;
      line.movable = false;
      line.zIndex = 10;
    </script>
</body>
</html>