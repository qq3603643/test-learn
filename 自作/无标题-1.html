<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        .box {
            width: 40px;
            height: 40px;
            border: 1px solid red;
            background: green;
            color: white;
            font: 20px/40px '';
            text-align: center;
            position: absolute;
            left: 20px;
            top: 20px;
            opacity: 0;
            line-height: 40px;
        }

    </style>
    <script>
        window.onload = function() {

            var getStyle = function(obj, attr) {
                return obj.currentStyle ? obj.currentStyle[attr] : getComputedStyle(obj)[attr];
            };
            var now = function() {
                return new Date().getTime();
            };
            var move = function(obj, json, times, fn) {

                clearInterval(obj.timer);
                var jsonCur = {},
                    oldtime = now();
                for (var attr in json) {
                    attr == 'opacity' ? jsonCur[attr] = getStyle(obj, 'opacity') * 100 :
                        jsonCur[attr] = parseInt(getStyle(obj, attr));
                }

                obj.timer = setInterval(function() {
                    var nowtime = new Date().getTime();
                    var t = (nowtime - oldtime) > times ? times : nowtime - oldtime,
                        value = Math.sqrt(t / times);

                    for (var attr in json) {
                        attr == 'opacity' ? obj.style.opacity = (jsonCur.opacity + value * (json[attr] * 100 - jsonCur[attr])) / 100 : obj.style[attr] = value * (json[attr] - jsonCur[attr]) + jsonCur[attr] + 'px';
                        console.log(value * (json[attr] - jsonCur[attr]))
                    }
                    if (t == times) {
                        clearInterval(obj.timer);
                        console.log('end')
                        if (fn) {
                            fn.call(obj);
                        }
                    }
                }, 13)
            };

            var word = '我知道，当你心绪沉重的时候,最好的礼物,是送你一片宁静的天空';

            for (var i = 0; i < word.length; i++) {
                var $div = document.createElement('div');
                $div.className = 'box';
                $div.innerHTML = word.charAt(i);
                document.body.appendChild($div);
            }

            var aDiv = document.getElementsByTagName('div');
            for (var j = 0; j < aDiv.length; j++) {
                if (j % 5 == 0) {
                    for (var l = 0; l < 5; l++) {
                        var m = j + l;
                        console.log(aDiv[m]);
                        aDiv[m].style.left = 520 + (50 * l) + 'px';
                        aDiv[m].style.top = 120 + (j / 5) * 50 + 'px';
                    }
                }
            }

            var shake = function(obj) {
                move(obj, {
                    lineHeight: 50
                }, 1000, function() {
                    move(obj, {
                        lineHeight: 30
                    }, 1000, function() {

                        shake(obj);
                    })
                })
            };

            var index = 0;
            var strt = function() {
                move(aDiv[index], {
                    'opacity': '0.8'
                }, 500, function(indexs) {
                    aDiv[index].style.display = 'none';
                    shake(aDiv[index]);
                    index++;
                    strt();
                    if (index == aDiv.length - 1) {
                        setTimeout(function() {
                            strt = null;
                            var timer = null;
                            var len = aDiv.length;
                            timer = setInterval(function() {

                                if (len == -1) {
                                    clearInterval(timer);
                                    ColorChange();
                                } else {
                                    len--;
                                    aDiv[len].style.backgroundColor = 'white';
                                    aDiv[len].style.color = 'black';
                                    aDiv[len].style.borderStyle = 'none';
                                    aDiv[len].style.display = 'block';
                                }
                            }, 100)
                        }, 500)

                    }
                });
            }
            strt();

            var ColorChange = function() {
                var aColor = ['green', 'red', 'pink', 'black', 'gray', 'auqa', 'fuchsia', 'limegreen', 'lilac', 'fuchsia', 'firebrick'];
                var aDiv = document.getElementsByTagName('div'),
                    len = aDiv.length,
                    lenC = aColor.length;
                setInterval(function() {
                    var sumC = Math.round(Math.random() * lenC),
                        sumD = Math.round(Math.random() * len);
                    document.title = sumC + '||' + sumD;
                    aDiv[sumD].style.color = aColor[sumC];
                }, 10)
            };
        }

    </script>
</head>

<body>


</body>

</html>
