<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        div{
            width: 50px;
            height: 50px;
            background: red;
        }
        .box{            
            margin: 0px 10px;
            border: 2px dashed gray;
            background: blue;
        }
    </style>
</head>
<body>
    <script>
        var test = function(){
            var my = {},$div,oDiv,i;  //这种模式可在之前定义好所需变量
                i = -1;
            my = {
                createEle: function(){
                    setTimeout(function(){
                        $div = document.createElement('div');
                        document.body.appendChild($div);
                    },4000)
                },
                addClass: function($ele){
                    console.log("div创建成功，正在添加样式");
                    setTimeout(function(){ $ele.className = 'box'; console.log('div添加样式成功');},2000)             
                    
                },
                checkEleL: function(){
                    try{
                        oDiv = document.getElementsByTagName('div')[0];
                        
                        if(!oDiv.nodeName) throw new Error(); 
                        if(oDiv.nodeName) my.addClass(oDiv);
                    }catch(e){
                        console.log('请等待div创建:'+ (i+=1) +'s');
                        setTimeout(arguments.callee,1000);
                    }
                },
                running: function(){
                    document.onclick = function(){
                        my.createEle();
                        my.checkEleL();
                    }
                }
            };
            return my;
        }();
        test.running();
        
    </script>    
</body>
</html>